%2.2:

%f'(0):
%úr extrapolation kom:

function r = R(f,a,h)
    r = (f(a+h) + f(a-h))/(2*h);
end

>>[X,mat1,mat2]=extrapolation(@(x)sin(x), 0, 0.5, 100, 1e-10)

X =

     1


mat1 =

  2.6201e-012


mat2 =

  1.0235e-014
  
%Úr Richardson kom:

>> [X,mat1,mat2]=richardson(@(x)sin(x), 0, 0.5, 100, 1e-10)

X =

     1


mat1 =

  2.6201e-012


mat2 =

  1.0235e-014

%f''(0):
%úr extrapolate:

function r = R(f,a,h)
    r = (f(a+h) + f(a-h) - 2*f(a))/(h*h);
end

>> [X,mat1,mat2]=extrapolation(@(x)sin(x), 0, 0.5, 100, 1e-10)

X =

     0


mat1 =

     0


mat2 =

     0

%Richardson reiknar bara f', þannig að skiptum út fyrir cos(x) = sin'(x)

>> [X,mat1,mat2]=richardson(@(x)cos(x), 0, 0.5, 100, 1e-10)

X =

     0


mat1 =

     0


mat2 =

     0
	 

%2.3:

%R.m:
function r = R(f,a,h,n)
    r=0;
    for i=0:n
        r = r + h*f(a+i*h);
    end
    r = r - h/2*(f(a) + f(a+n*h));
end

%Útkoma:

>> [X,mat1,mat2]=extrapolation(@(x) sin(x),0,pi/2,100,1e-10)
X =
    1.0000
mat1 =
  1.9832e-012
mat2 =
  1.9368e-015
  
%Annað dæmi:

>> [X,mat1,mat2]=extrapolation(@(x) exp(x),0,1,100,1e-10)
X =
    1.7183
mat1 =
  3.2863e-014
mat2 =
  3.2124e-017
  
%2.4:
%R.m:

function r = R(f,a,h)
    r=[(f(a+h*[1 0]) - f(a-h*[1 0]))/(2*h);(f(a+h*[0 1]) - f(a-h*[0 1]))/(2*h)];
end

%keyrsla:

>> [X,mat1,mat2]=extrapolation(@(x) x(1)^2 - x(2)^2,[1 1],1,100,1e-10)
X(:,:,1) =
     2
X(:,:,2) =
    -2
mat1 =
     0
mat2 =
     0
	 
%Annað dæmi:

>> [X,mat1,mat2]=extrapolation(@(x) sin(x(1))*cos(x(2)),[1 1],1,100,1e-10)
X(:,:,1) =
    0.2919
X(:,:,2) =
   -0.7081
mat1 =
  1.7925e-014
mat2 =
  1.7522e-017
  
%2.5:
%R.m:

function r = R(f,a,h)
    A = (f(a + h*[1 0]) +f(a-h*[1 0]) - 2*f(a))/(h*h);
    C = (f(a + h*[0 1]) +f(a-h*[0 1]) - 2*f(a))/(h*h);
    B = (f(a + h*[1 0] + h*[0 1]) - f(a + h*[1 0] - h*[0 1]) - f(a - h*[1 0] + h*[0 1]) + f(a - h*[1 0] - h*[0 1]))/(4*h*h);
    r=[A B; B C];
end

%Prufa:

>> [X,mat1,mat2]=extrapolation(@(x) x(1)^2 - x(2)^2,[1 1],1,100,1e-10)
X =
     2     0
     0    -2
mat1 =
     0
mat2 =
     0
	 
%Annað dæmi:

>> [X,mat1,mat2]=extrapolation(@(x) sin(x(1))*cos(x(2)),[1 1],1,100,1e-10)
X =
   -0.4546   -0.4546
   -0.4546   -0.4546
mat1 =
  1.8373e-012
mat2 =
  1.7942e-015